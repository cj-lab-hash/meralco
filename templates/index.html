
<!DOCTYPE html>
<html>
<head>
    <title>Billing System</title>
</head>
<body>
    <h1>Billing Form</h1>
    <form method="POST">
        <label>Actual Bill:</label>
        <input type="text" name="actual_bill" required><br>

        <label>Previous Reading:</label>
        <input type="text" name="previous_reading" required><br>

        <label>Current Reading:</label>
        <input type="text" name="current_reading" required><br>

        <label>Ate Gen Previous Reading:</label>
        <input type="text" name="ate_gen_previous" required>
        <button type="button" onclick="copyAteGenPreviousReading()">Copy Previous Reading</button><br>

        <label>Ate Gen Current Reading:</label>
        <input type="text" name="ate_gen_current" required><br>

        <input type="submit" value="Submit">
    </form>

    <h2>Billing Records</h2>
    <table border="1">
        <tr>
            <th>ID</th>
            <th>Actual Bill</th>
            <th>Previous Reading</th>
            <th>Current Reading</th>
            <th>Consumption</th>
            <th>Rate per kWh</th>
            <th>Ate Gen Previous</th>
            <th>Ate Gen Current</th>
            <th>Ate Gen Consumption</th>
            <th>Ate Gen Share</th>
            <th>JM Share</th>
        </tr>
        {% for record in records %}
        <tr>
            <td>{{ record['id'] }}</td>
            <td>{{ record['actual_bill'] }}</td>
            <td>{{ record['previous_reading'] }}</td>
            <td>{{ record['current_reading'] }}</td>
            <td>{{ record['consumption'] }}</td>
            <td>{{ record['rate_per_kwh'] }}</td>
            <td>{{ record['ate_gen_previous'] }}</td>
            <td>{{ record['ate_gen_current'] }}</td>
            <td>{{ record['ate_gen_consumption'] }}</td>
            <td>{{ record['ate_gen_share'] }}</td>
            <td>{{ record['jm_share'] }}</td>
        </tr>
        {% endfor %}
    </table>

    <script>
    function copyAteGenPreviousReading() {
        const table = document.querySelector("table");
        if (!table) return;

        const rows = table.querySelectorAll("tr");
        if (rows.length < 2) return;

        const lastRow = rows[rows.length - 1];
        const cells = lastRow.querySelectorAll("td");

        // Assuming 'Ate Gen Current Reading' is at index 7
        const ateGenCurrentReading = cells[7]?.innerText;
        if (ateGenCurrentReading) {
            document.querySelector("input[name='ate_gen_previous']").value = ateGenCurrentReading;
        }
    }
    </script>
</body>
</html>
